
<!DOCTYPE html>


<html lang="ru" data-content_root="../../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1. Подключение Cisco IOS и Ideco NGFW по IPsec &#8212; Ideco NGFW</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../../../../../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../../../../../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../../../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../../../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../../../../../../_static/documentation_options.js?v=576a2c22"></script>
    <script src="../../../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../../../../../../_static/translations.js?v=29b1f277"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'repo/docsUTM/settings/services/ipsec/site-to-site/connect-utm-to-cisco-via-ipsec';</script>
    <link rel="index" title="Алфавитный указатель" href="../../../../../../genindex.html" />
    <link rel="search" title="Поиск" href="../../../../../../search.html" />
    <link rel="next" title="1. Подключение pfSense к Ideco NGFW по IPsec" href="ipsec-connection-pfsense-to-utm.html" />
    <link rel="prev" title="1. Подключение MikroTik и Ideco NGFW по L2TP/IPsec и IKev2/IPsec" href="utm-to-mikrotik-vpn.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="ru"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Перейти к основному содержанию</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<h3><a href="../../../../../../index.html">Оглавление</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../README.html">1. Об Ideco NGFW</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../general/license.html">1. Лицензирование</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../general/data-update-source-ideco-utm.html">1. Cистемные требования и источники обновления данных Ideco NGFW</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../general/technical-support.html">1. Техническая поддержка</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation/tips-for-initial-setup.html">1. Рекомендации при первоначальной настройке</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation/initial-action-my-ideco.html">1. Личный кабинет my.ideco</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation/preparation-install.html">1. Подготовка к установке на устройство</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation/specifics-of-hypervisor-settings.html">1. Настройка гипервизора</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation/usb.html">1. Создание загрузочного USB flash-диска</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation/installation-process.html">1. Установка</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation/initial-setup.html">1. Первоначальная настройка</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation/server-registration.html">1. Регистрация сервера</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../monitor-panel.html">1. Панель мониторинга</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/README.html">1. Пользователи</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/user-tree/README.html">1. Учетные записи</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/user-tree/user-management.html">1. Управление пользователями</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/user-tree/customization-of-users.html">1. Настройка пользователей</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/authorization/README.html">1. Авторизация пользователей</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/authorization/web-authorization.html">1. Веб-аутентификация</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/authorization/ip-and-mac-authorization/README.html">1. IP и MAC авторизация</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/authorization/ip-and-mac-authorization/ip-authorization.html">1. Авторизация по IP-адресу</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/authorization/ip-and-mac-authorization/mac-authorization.html">1. Авторизация по MAC-адресу</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/authorization/authorization-by-subnet.html">1. Авторизация по подсетям</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/authorization/terminal-server.html">1. Авторизация пользователей терминальных серверов</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/user-personal-account.html">1. Личный кабинет пользователя</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/authorization/vpn-connection/README.html">1. VPN-подключения</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/two-factor-authentication.html">1. Двухфакторная аутентификация</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/authorization/vpn-connection/pptp.html">1. Подключение по PPTP</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/authorization/vpn-connection/pppoe.html">1. Подключение по PPPoE</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/authorization/vpn-connection/ipsec-ikev2.html">1. Подключение по IKEv2/IPsec</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/authorization/vpn-connection/sstp.html">1. Подключение по SSTP</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/authorization/vpn-connection/l2tp-ipsec.html">1. Подключение по L2TP/IPsec</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/authorization/vpn-connection/features.html">1. Особенности маршрутизации и организации доступа</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/authorization/vpn-connection/running-powershell-scripts.html">1. Инструкция по запуску PowerShell скриптов</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/ideco-client/README.html">1. Ideco Client</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/ideco-client/ideco-client-windows.html">1. Установка и настройка Ideco Client на Windows</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/ideco-client/ideco-client-macos.html">1. Установка и настройка Ideco Client на MacOS</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/hip-profiles.html">1. Профили устройств</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/active-directory/README.html">1. Интеграция с Microsoft Active Directory/Samba DC</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/active-directory/entering-the-server-into-the-domain.html">1. Ввод сервера в домен</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/active-directory/active-directory-user-authorization.html">1. Аутентификация пользователей AD/Samba DC</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/active-directory/auto-de-authorization-script.html">1. Скрипты автоматической разавторизации</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/active-directory/user-import.html">1. Импорт пользователей</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/radius.html">1. Интеграция с RADIUS-сервером</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/ald-pro.html">1. ALD Pro</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/device-discovery.html">1. Обнаружение устройств</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../users/wifi-network.html">1. Wi-Fi-сети</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../monitor/README.html">1. Мониторинг</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../monitor/authorized-users.html">1. Авторизованные пользователи</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../monitor/workload-schedule.html">1. График загруженности</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../monitor/traffic.html">1. Монитор трафика</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../monitor/telegram-bot.html">1. Telegram-бот</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../monitor/snmp.html">1. SNMP</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../monitor/zabbix.html">1. Интеграция с Zabbix</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/README.html">1. Правила трафика</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/firewall.html">1. Файрвол</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/firewall-tables.html">1. Таблицы файрвола (FORWARD, DNAT, INPUT и SNAT)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/logging.html">1. Логирование</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/application-control.html">1. Контроль приложений</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/content-filter/README.html">1. Контент-фильтр</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/content-filter/custom-categories.html">1. Описание категорий контент-фильтра</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/content-filter/filtering-https-traffic.html">1. Настройка фильтрации HTTPS</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/content-filter/block-page.html">1. Изменение страницы блокировки Контент-фильтра</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/shaper.html">1. Ограничение скорости</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/antivirus.html">1. Антивирусы веб-трафика</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/ips/README.html">1. Предотвращение вторжений</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/ips/log.html">1. Журнал</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/ips/rules.html">1. Правила</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/ips/exceptions-rules.html">1. Исключения из правил</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/ips/settings.html">1. Настройки</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/ips/user-ip-exceptions.html">1. Исключения</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/aliases.html">1. Объекты</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../access-rules/quotas.html">1. Квоты</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../README.html">1. Сервисы</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../connection-to-provider/README.html">1. Сетевые интерфейсы</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../connection-to-provider/local-ethernet.html">1. Настройка Локального Ethernet</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../connection-to-provider/ethernet-connection.html">1. Настройка Внешнего Ethernet</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../connection-to-provider/pptp-connection.html">1. Подключение по PPTP</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../connection-to-provider/l2tp-connection.html">1. Настройка подключения по L2TP</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../connection-to-provider/pppoe-connection.html">1. Подключение по PPPoE</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../connection-to-provider/3g-4g-connection.html">1. Подключение по 3G и 4G</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../multiple-simultaneous-connections.html">1. Балансировка и резервирование</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../routing.html">1. Маршрутизация</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../bgp.html">1. BGP</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ospf.html">1. OSPF</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../igmp.html">1. IGMP Proxy</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../proxy/README.html">1. Прокси</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../proxy/exclusions.html">1. Исключения</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../proxy/direct-connection-proxy.html">1. Настройка прямого подключения к прокси</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../proxy/proxy-single-interface.html">1. Настройка прокси с одним интерфейсом</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../reverse-proxy.html">1. Обратный прокси</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dns/README.html">1. DNS</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dns/dns-external.html">1. Внешние DNS-серверы</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dns/master-zon.html">1. Master-зоны</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dns/forward-zon.html">1. Forward-зоны</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dns/ddns.html">1. DDNS</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dhcp.html">1. DHCP-сервер</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ntp.html">1. NTP-сервер</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../README.html">1. IPsec</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ipsec-utm-to-utm-tunnel.html">1. Подключение между двумя Ideco NGFW в туннельном режиме работы</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ipsec-utm-to-utm-transport.html">1. Подключение между двумя Ideco NGFW в транспортном режиме работы</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="site-to-site-ideco-mikrotik.html">1. Подключение Ideco NGFW и MikroTik</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="utm-to-mikrotik-vpn.html">1. Подключение MikroTik и Ideco NGFW по L2TP/IPsec и IKev2/IPsec</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. Подключение Cisco IOS и Ideco NGFW по IPsec</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">1.1. Настройка подключения в туннельном режиме</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ideco-ngfw">1.1.1. Настройка Ideco NGFW</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cisco-ios-ex">1.1.2. Настройка Cisco IOS EX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cisco">1.1.2.1. Настройка Cisco через консоль</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ikev2-ipsec-cisco">1.1.3. Настройка IKEv2+IPsec на Cisco</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id2">1.2. Настройка подключения в транспортном режиме</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">1.2.1. Настройка Ideco NGFW</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cisco-ios">1.2.2. Настройка Cisco IOS через консоль</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ikev2-gre-over-ipsec-cisco">1.2.3. Настройка IKEv2+GRE-over-IPsec на Cisco</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ipsec-connection-pfsense-to-utm.html">1. Подключение pfSense к Ideco NGFW по IPsec</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ipsec-connection-kerio-control-to-utm.html">1. Подключение Kerio Control и Ideco NGFW по IPsec</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="keenetic-connection.html">1. Подключение Keenetic по SSTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="keenetic-connection.html#keenetic-ipsec">2. Подключение Keenetic по IPsec</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../certificates/README.html">1. Сертификаты</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../certificates/upload-ssl-certificate-to-server.html">1. Загрузка SSL-сертификата на сервер</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../certificates/creating-ssl-sert-powershell.html">1. Создание самоподписанного сертификата c помощью PowerShell</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../certificates/creating-openssl-cert.html">1. Создание самоподписанного сертификата c помощью openssl</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../reports/README.html">1. Отчеты и журналы</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../reports/traffic.html">1. Трафик</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../reports/logs.html">1. Журнал событий</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../reports/web-logs.html">1. Журнал веб-доступа</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../reports/antivirus-logs.html">1. Журнал антивируса</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../reports/security-events.html">1. События безопасности</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../reports/administrator-actions.html">1. Действия администраторов</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../reports/authorization-log.html">1. Журнал авторизации</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../reports/report-designer.html">1. Конструктор отчетов</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../reports/syslog.html">1. Syslog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../server-management/README.html">1. Управление сервером</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../server-management/admins.html">1. Администраторы</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../server-management/central-console.html">1. Центральная консоль</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../server-management/vce.html">1. VCE</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../server-management/cluster.html">1. Кластеризация</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../server-management/server-update.html">1. Автоматическое обновление</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../server-management/server-update.html#id2">2. Процесс выхода релизов в каналы обновлений</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../server-management/server-update.html#ngfw">3. Особенности обновления NGFW</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../server-management/backup.html">1. Бекапы на удаленное файловое хранилище по протоколу FTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../server-management/backup.html#netbios-cifs">2. Бекапы на сетевое файловое хранилище по протоколу NetBIOS (CIFS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../server-management/backup.html#id1">3. Бекапы на локальный жесткий диск</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../server-management/backup.html#id2">4. Восстановление конфигурации из бекапа</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../server-management/terminal.html">1. Терминал</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../server-management/license-management.html">1. Лицензия</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../server-management/additionally.html">1. Дополнительно</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../mail/README.html">1. Почтовый релей</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../mail/mail-server-settings/README.html">1. Основные настройки</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../mail/mail-server-settings/web-mail.html">1. Web-почта</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../mail/mail-server-settings/mail-relay-settings.html">1. Настройка почтового релея</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../mail/mail-server-settings/mail-server-settings.html">1. Настройка почтового сервера</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../mail/advanced-settings/README.html">1. Расширенные настройки</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../mail/advanced-settings/domain-settings-at-zone-holder.html">1. Настройка домена у регистратора/держателя зоны</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../mail/antispam.html">1. Антиспам</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../mail/regulations/README.html">1. Правила</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../mail/regulations/mail-forwarding.html">1. Переадресация почты</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../mail/mail-queue.html">1. Почтовая очередь</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../mail/configuring-email-clients.html">1. Настройка почтовых клиентов</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../mail/filtering-scheme-for-mail-traffic.html">1. Схема фильтрации почтового трафика</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../publishing-resources/README.html">1. Публикация ресурсов</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../publishing-resources/access-from-external-network-without-nat.html">1. Доступ из внешней сети без NAT</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../publishing-resources/publishing-web-applications.html">1. Публикация веб-приложений (обратный прокси-сервер)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../publishing-resources/configure-public-ip-on-computer-on-the-local-net.html">1. Настройка публичного IP-адреса на компьютере в локальной сети</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../publishing-resources/portmapping.html">1. Портмаппинг (проброс портов, DNAT)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../skydns.html">1. Интеграция NGFW и SkyDNS</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../settings-my/README.html">1. О личном кабинете MY.IDECO</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../settings-my/ngfw.html">1. NGFW</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../settings-my/bot-security.html">1. Monitoring Bot и Security</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../settings-my/personal-details-and-companies.html">1. Личные данные и Компании</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../settings-cc/README.html">1. Об Ideco Center</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../settings-cc/setup.html">1. Установка Ideco Center</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../settings-cc/servers.html">1. Серверы</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../settings-cc/monitor.html">1. Мониторинг</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../settings-cc/policies-and-objects.html">1. Политики и объекты</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../settings-cc/services.html">1. Сервисы</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../settings-cc/reports.html">1. Отчеты и журналы</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../settings-cc/server-management.html">1. Управление сервером</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/README.html">1. FAQ</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/remote-assistant.html">1. Режим удаленного помощника</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/allow-internet-all.html">1. Разрешить интернет всем: диагностика неполадок</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/remote-access-for-server-management.html">1. Удаленный доступ к серверу</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/memory-testing.html">1. Тестирование оперативной памяти сервера</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/vpn/README.html">1. Инструкции по созданию VPN-подключений</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/vpn/connection-for-ubuntu.html">1. Создание VPN-подключения в Ubuntu</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/vpn/connection-for-fedora.html">1. Инструкция по созданию подключения в Fedora</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/vpn/connection-for-astra-linux.html">1. Инструкция по созданию подключения в Astra Linux</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/vpn/auto-connect.html">1. Автоматическое создание подключений</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/vpn/connection-for-windows10.html">1. Инструкция по созданию подключения в Windows 10</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/vpn/connection-for-windows7.html">1. Создание подключения в Windows 7</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/vpn/connection-for-mobile-devices.html">1. Инструкция по созданию VPN-подключения на мобильных устройствах</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/vpn/connection-for-high-sierra-macos.html">1. Инструкция по созданию подключения в Mac OS</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/vpn/sstp-connecting-keenetic-wi-fi-routers.html">1. Подключение по SSTP Wi-Fi-роутеров Keenetic</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/access-to-remote-networks.html">1. Как избавиться от асимметричной маршрутизации трафика</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/dnsbl-list.html">1. Что делать если IP попал в черные списки DNSBL</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/restore-access-to-ideco-utm.html">1. Как восстановить доступ к Ideco NGFW</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/go-back.html">1. Как восстановиться на прошлую версию после обновления Ideco NGFW</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/security-ideco.html">1. Проверка настроек фильтрации с помощью security ideco</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/choosing-hardware-platform.html">1. Выбор аппаратной платформы для Ideco NGFW</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/legacy-encryption-support.html">1. Поддержка устаревших алгоритмов шифрования</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/configuring-proxifier.html">1. Настройка программы Proxifier для прямых подключений к прокси серверу</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/blocking-popular-resources.html">1. Блокировка популярных ресурсов</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/authorization-astra-linux.html">1. Настройка прозрачной авторизации на Astra linux</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/auto-authorization-linux.html">1. Инструкция по настройке автоматической веб-аутентификации на Ideco NGFW</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/auto-authorization-linux.html#id1">2. Настройка автозагрузки скрипта</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/transferring-data-to-another-server.html">1. Перенос данных и настроек на другой сервер</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/processing-order.html">1. Порядок обработки веб-трафика в Ideco NGFW</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/integrity.html">1. Интеграция Ideco NGFW и брокера сетевых пакетов DS Integrity NG</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/vipnet-coordinator.html">1. Рекомендации по настройке NGFW для работы совместно с ViPNet-координатором</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/block-chat-bot.html">1. Блокировка чат-ботов</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/open-ports.html">1. Доступные из внешней сети</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/open-ports.html#id2">2. Доступные из локальной сети</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/popular-recipes/open-ports.html#id3">3. Как проверить, открыт ли порт</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/problem-diagnosis/README.html">1. Диагностика проблем</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/problem-diagnosis/site-does-not-open.html">1. Ошибка при открытии сайта ERR_CONNECTION_TIMED_OUT или Не открывается сайт</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/problem-diagnosis/what-to-do-if-the-internet-does-not-work.html">1. Что делать, если не работает интернет</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/problem-diagnosis/old-browser.html">1. Ошибка при авторизации «The browser is outdated»</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../recipes/problem-diagnosis/ipsec.html">1. Если соединение по IPsec не устанавливается</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/description-of-handlers.html">1. Описание основных хендлеров</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/active-directory-api.html">1. Управление интеграцией с Active Directory</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/user-management-api.html">1. Управление пользователями и группами</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/access-rules-api.html">1. Управление правилами трафика</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/dhcp-api.html">1. DHCP-сервер</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/dns-api.html">1. DNS-сервер</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/logs-api.html">1. Настройка удаленной передачи системных логов (Syslog)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/cc-api.html">1. Центральная консоль</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/backup-api.html">1. Бекапы</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/examples/README.html">1. Примеры использования</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/examples/editing-a-custom-category.html">1. Редактирование пользовательской категории контент-фильтра</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/examples/creating-a-forward-rule.html">1. Создание правила Forward</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../changelog/ideco-utm/README.html">1. Ideco NGFW 17.X</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../changelog/cc/README.html">1. Ideco Center 17.Х</a></li>
</ul>
</div>
        <div class="sidebar-primary-item">

  <div class="tocsection sourcelink">
    <a href="../../../../../../_sources/repo/docsUTM/settings/services/ipsec/site-to-site/connect-utm-to-cisco-via-ipsec.md">
      <i class="fa-solid fa-file-lines"></i> Исходный текст
    </a>
  </div>
</div>
        <div class="sidebar-primary-item">
<div id="searchbox"></div></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Загрузите эту страницу">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../../../_sources/repo/docsUTM/settings/services/ipsec/site-to-site/connect-utm-to-cisco-via-ipsec.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Скачать исходный файл"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Распечатать в PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Полноэкранный режим"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="светлая/темная" aria-label="светлая/темная" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Поиск" aria-label="Поиск" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Подключение Cisco IOS и Ideco NGFW по IPsec</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Содержание </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1.1. Настройка подключения в туннельном режиме</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ideco-ngfw">1.1.1. Настройка Ideco NGFW</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cisco-ios-ex">1.1.2. Настройка Cisco IOS EX</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cisco">1.1.2.1. Настройка Cisco через консоль</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ikev2-ipsec-cisco">1.1.3. Настройка IKEv2+IPsec на Cisco</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">1.2. Настройка подключения в транспортном режиме</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">1.2.1. Настройка Ideco NGFW</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cisco-ios">1.2.2. Настройка Cisco IOS через консоль</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ikev2-gre-over-ipsec-cisco">1.2.3. Настройка IKEv2+GRE-over-IPsec на Cisco</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="cisco-ios-ideco-ngfw-ipsec">
<h1><span class="section-number">1. </span>Подключение Cisco IOS и Ideco NGFW по IPsec<a class="headerlink" href="#cisco-ios-ideco-ngfw-ipsec" title="Link to this heading">#</a></h1>
<section id="id1">
<h2><span class="section-number">1.1. </span>Настройка подключения в туннельном режиме<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>Рассмотрим настройку подключения по схеме ниже:</p>
<p><img alt="" src=".gitbook/assets/connect-utm-to-cisco-via-ipsec1.png" /></p>
<p>Для настройки подключения Cisco IOS к Ideco NGFW нужно следовать инструкции в каждом из пунктов.</p>
<details>
<summary>Первоначальная настройка Ideco NGFW и Cisco IOS</summary>
<section id="ideco-ngfw">
<h3><span class="section-number">1.1.1. </span>Настройка Ideco NGFW<a class="headerlink" href="#ideco-ngfw" title="Link to this heading">#</a></h3>
<p>Настройте на Ideco NGFW локальный и внешний интерфейсы. Подробная информация находится в статье <a class="reference internal" href="#/installation/initial-setup.md"><span class="xref myst">Первоначальная настройка</span></a>.</p>
</section>
<section id="cisco-ios-ex">
<h3><span class="section-number">1.1.2. </span>Настройка Cisco IOS EX<a class="headerlink" href="#cisco-ios-ex" title="Link to this heading">#</a></h3>
<p>Настройку Cisco можно осуществить через консоль устройства или, воспользовавшись нашими конфигурационными скриптами, сгенерированными по адресу <a class="reference external" href="https://cisco.ideco.ru">https://cisco.ideco.ru/</a>.</p>
<section id="cisco">
<h4><span class="section-number">1.1.2.1. </span>Настройка Cisco через консоль<a class="headerlink" href="#cisco" title="Link to this heading">#</a></h4>
<p>1. Настройка локального интерфейса:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">enable</span>
<span class="n">conf</span> <span class="n">t</span>
<span class="n">interface</span> <span class="n">GigabitEthernet2</span>
<span class="n">ip</span> <span class="n">address</span> <span class="o">&lt;</span><span class="n">локальный</span> <span class="n">IP</span> <span class="n">Cisco</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">маска</span> <span class="n">подсети</span><span class="o">&gt;</span>
<span class="n">no</span> <span class="n">shutdown</span>
<span class="n">ip</span> <span class="n">nat</span> <span class="n">inside</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>2. Настройка внешнего интерфейса:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">interface</span> <span class="n">GigabitEthernet1</span>
<span class="n">ip</span> <span class="n">address</span> <span class="o">&lt;</span><span class="n">внешний</span> <span class="n">IP</span> <span class="n">Cisco</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">маска</span> <span class="n">подсети</span><span class="o">&gt;</span>
<span class="n">no</span> <span class="n">shutdown</span>
<span class="n">ip</span> <span class="n">nat</span> <span class="n">outside</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>3. Проверьте наличие связи между внешними интерфейсами Ideco NGFW и Cisco. Для этого в консоли Cisco используйте команду <code class="docutils literal notranslate"><span class="pre">ping</span> <span class="pre">&lt;внешний</span> <span class="pre">IP</span> <span class="pre">NGFW&gt;</span></code>. Результат вывода команды - наличие ICMP-ответов.</p>
<p>4. Создание access-list с адресацией локальной сети (подробную информацию можно прочитать в <a class="reference external" href="https://www.cisco.com/c/ru_ru/support/docs/security/ios-firewall/23602-confaccesslists.html">статье</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ip</span> <span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="n">extended</span> <span class="n">NAT</span>
<span class="n">permit</span> <span class="n">ip</span> <span class="o">&lt;</span><span class="n">локальная</span> <span class="n">подсеть</span> <span class="n">Cisco</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">обратная</span> <span class="n">маска</span> <span class="n">подсети</span><span class="o">&gt;</span> <span class="nb">any</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>5. Настройка NAT (подробную информацию можно прочитать в <a class="reference external" href="https://www.cisco.com/c/ru_ru/support/docs/ip/network-address-translation-nat/13772-12.html">статье</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ip</span> <span class="n">nat</span> <span class="n">inside</span> <span class="n">source</span> <span class="nb">list</span> <span class="n">NAT</span> <span class="n">interface</span> <span class="n">GigabitEthernet1</span> <span class="n">overload</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>6. Сохранение настроек конфигурации:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">write</span> <span class="n">memory</span>
</pre></div>
</div>
<p>7. <strong>После сохранения настроек проверьте, что из локальной сети Cisco присутствует доступ в сеть интернет.</strong><br />
Для этого перейдите на какой-нибудь сайт (например: <a class="reference external" href="https://www.cisco.com">https://www.cisco.com/</a>) с устройства в локальной сети Cisco.</p>
</section>
</section>
<section id="ikev2-ipsec-cisco">
<h3><span class="section-number">1.1.3. </span>Настройка IKEv2+IPsec на Cisco<a class="headerlink" href="#ikev2-ipsec-cisco" title="Link to this heading">#</a></h3>
<p>1. Создание proposal (подробную информацию можно прочитать в <a class="reference external" href="https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/sec_conn_ike2vpn/configuration/xe-16-8/sec-flex-vpn-xe-16-8-book/sec-cfg-ikev2-flex.html#GUID-6F6D8166-508A-4669-9DDC-4FE7AE9B9939__GUID-A5DB59F5-70A0-421E-86AE-AE983B283E6F">статье</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conf</span> <span class="n">t</span>
<span class="n">crypto</span> <span class="n">ikev2</span> <span class="n">proposal</span> <span class="n">ikev2proposal</span>
<span class="n">encryption</span> <span class="n">aes</span><span class="o">-</span><span class="n">cbc</span><span class="o">-</span><span class="mi">256</span>
<span class="n">integrity</span> <span class="n">sha256</span>
<span class="n">group</span> <span class="mi">19</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>2. Создание policy (подробную информацию можно прочитать в <a class="reference external" href="https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/sec_conn_ike2vpn/configuration/xe-16-8/sec-flex-vpn-xe-16-8-book/sec-cfg-ikev2-flex.html#GUID-B5C198FE-97D9-4F74-88C6-6B5802195772__GUID-613A19C3-C5D6-456A-8D8A-4693F3553ED3">статье</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">crypto</span> <span class="n">ikev2</span> <span class="n">policy</span> <span class="n">ikev2policy</span>
<span class="k">match</span> <span class="n">fvrf</span> <span class="nb">any</span>
<span class="n">proposal</span> <span class="n">ikev2proposal</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>3. Создание peer (key_id - идентификатор удаленной стороны, т. е. Ideco NGFW). Подробную информацию можно прочитать в <a class="reference external" href="https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/sec_conn_ike2vpn/configuration/xe-16-8/sec-flex-vpn-xe-16-8-book/sec-cfg-ikev2-flex.html#GUID-D6AC9B42-1F22-4F60-A06A-A72575181659__GUID-A1CB9A0A-6098-475C-99BE-5D41009CD9A9">статье</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">crypto</span> <span class="n">ikev2</span> <span class="n">keyring</span> <span class="n">key</span>
<span class="n">peer</span> <span class="n">strongswan</span>
<span class="n">address</span> <span class="o">&lt;</span><span class="n">внешний</span> <span class="n">IP</span> <span class="n">NGFW</span><span class="o">&gt;</span>
<span class="n">identity</span> <span class="n">key</span><span class="o">-</span><span class="nb">id</span> <span class="o">&lt;</span><span class="n">key_id</span><span class="o">&gt;</span>
<span class="n">pre</span><span class="o">-</span><span class="n">shared</span><span class="o">-</span><span class="n">key</span> <span class="n">local</span> <span class="o">&lt;</span><span class="n">psk</span><span class="o">&gt;</span>
<span class="n">pre</span><span class="o">-</span><span class="n">shared</span><span class="o">-</span><span class="n">key</span> <span class="n">remote</span> <span class="o">&lt;</span><span class="n">psk</span><span class="o">&gt;</span>
<span class="n">exit</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>4. Создание IKEv2 profile (подробную информацию можно прочитать в <a class="reference external" href="https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/sec_conn_ike2vpn/configuration/xe-16-8/sec-flex-vpn-xe-16-8-book/sec-cfg-ikev2-flex.html#task_20288C58E8B1416897A763FABA8B0885__GUID-B31A2B1F-E07A-4DA9-8CEA-45D92E283D14">статье</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">crypto</span> <span class="n">ikev2</span> <span class="n">profile</span> <span class="n">ikev2profile</span>
<span class="k">match</span> <span class="n">identity</span> <span class="n">remote</span> <span class="n">address</span> <span class="o">&lt;</span><span class="n">внешний</span> <span class="n">IP</span> <span class="n">NGFW</span><span class="o">&gt;</span> <span class="mf">255.255.255.255</span>
<span class="n">authentication</span> <span class="n">remote</span> <span class="n">pre</span><span class="o">-</span><span class="n">share</span>
<span class="n">authentication</span> <span class="n">local</span> <span class="n">pre</span><span class="o">-</span><span class="n">share</span>
<span class="n">keyring</span> <span class="n">local</span> <span class="n">key</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>5. Настройка шифрования в esp:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">crypto</span> <span class="n">ipsec</span> <span class="n">transform</span><span class="o">-</span><span class="nb">set</span> <span class="n">TS</span> <span class="n">esp</span><span class="o">-</span><span class="n">gcm</span> <span class="mi">256</span>
<span class="n">mode</span> <span class="n">tunnel</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>6. Создание ipsec-isakmp:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">crypto</span> <span class="nb">map</span> <span class="n">cmap</span> <span class="mi">10</span> <span class="n">ipsec</span><span class="o">-</span><span class="n">isakmp</span>
<span class="nb">set</span> <span class="n">peer</span> <span class="o">&lt;</span><span class="n">внешний</span> <span class="n">IP</span> <span class="n">NGFW</span><span class="o">&gt;</span>
<span class="nb">set</span> <span class="n">transform</span><span class="o">-</span><span class="nb">set</span> <span class="n">TS</span>
<span class="nb">set</span> <span class="n">ikev2</span><span class="o">-</span><span class="n">profile</span> <span class="n">ikev2profile</span>
<span class="k">match</span> <span class="n">address</span> <span class="n">cryptoacl</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>7. Настройка crypto map на внешнем интерфейсе:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">interface</span> <span class="n">GigabitEthernet1</span>
<span class="n">crypto</span> <span class="nb">map</span> <span class="n">cmap</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>8. Создание access-list для трафика между локальными сетями Cisco и NGFW:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ip</span> <span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="n">extended</span> <span class="n">cryptoacl</span>
<span class="n">permit</span> <span class="n">ip</span> <span class="o">&lt;</span><span class="n">локальная</span> <span class="n">подсеть</span> <span class="n">Cisco</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">обратная</span> <span class="n">маска</span> <span class="n">подсети</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">локальная</span> <span class="n">подсеть</span> <span class="n">NGFW</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">обратная</span> <span class="n">маска</span> <span class="n">подсети</span><span class="o">&gt;</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>9. Добавление в access-list NAT исключения трафика между локальными сетями Cisco и NGFW (правило <code class="docutils literal notranslate"><span class="pre">deny</span></code> должно оказаться выше чем <code class="docutils literal notranslate"><span class="pre">permit</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ip</span> <span class="n">access</span><span class="o">-</span><span class="nb">list</span> <span class="n">extended</span> <span class="n">NAT</span>
<span class="n">no</span> <span class="n">permit</span> <span class="n">ip</span> <span class="o">&lt;</span><span class="n">локальная</span> <span class="n">подсеть</span> <span class="n">Cisco</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">обратная</span> <span class="n">маска</span> <span class="n">подсети</span><span class="o">&gt;</span> <span class="nb">any</span>
<span class="n">deny</span> <span class="n">ip</span> <span class="o">&lt;</span><span class="n">локальная</span> <span class="n">подсеть</span> <span class="n">Cisco</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">обратная</span> <span class="n">маска</span> <span class="n">подсети</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">локальная</span> <span class="n">подсеть</span> <span class="n">NGFW</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">обратная</span> <span class="n">маска</span> <span class="n">подсети</span><span class="o">&gt;</span>
<span class="n">permit</span> <span class="n">ip</span> <span class="o">&lt;</span><span class="n">локальная</span> <span class="n">подсеть</span> <span class="n">Cisco</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">обратная</span> <span class="n">маска</span> <span class="n">подсети</span><span class="o">&gt;</span> <span class="nb">any</span>
<span class="n">exit</span>

<span class="n">end</span>
</pre></div>
</div>
<p>10. Сохранение настроек конфигурации:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">write</span> <span class="n">memory</span>
</pre></div>
</div>
</details>
<details>
<summary>Настройка исходящего подключения на Ideco NGFW</summary>
<p>Для настройки исходящего IPsec-подключения на Ideco NGFW выполните действия:</p>
<p>1. В веб-интерфейсе Ideco NGFW откройте вкладку <strong>Сервисы -&gt; IPsec -&gt; Исходящие подключения</strong>.</p>
<p>2. Добавьте новое подключение:</p>
<ul class="simple">
<li><p><strong>Название</strong> - любое;</p></li>
<li><p><strong>Зона</strong> - укажите зону для добавления IPSec подключения;</p></li>
<li><p><strong>Режим работы</strong> - выберите <strong>Туннельный</strong>;</p></li>
<li><p><strong>Адрес удаленного устройства</strong> - введите IP-адрес Cisco;</p></li>
<li><p><strong>IP-адрес интерфейса туннеля</strong> - укажите IP-адрес интерфейса туннеля. Поле необязательное, заполняется при настройке BGP-соседства для динамической маршрутизации и для получения статистики обмена пакетами;</p></li>
<li><p><strong>Удаленный IP-адрес туннеля</strong> - укажите IP-адрес интерфейса туннеля Cisco. Поле необязательное. Для получения статистики о потере пакетов, средней задержке и джиттере заполните поля <strong>IP-адрес интрефейса туннеля</strong> и <strong>Удаленный IP-адрес туннеля</strong>. Они должны находиться в одной подсети.</p></li>
<li><p><strong>Домашние локальные сети</strong> - укажите локальную сеть Ideco NGFW;</p></li>
<li><p><strong>Удаленные локальные сети</strong> - укажите локальную сеть Cisco;</p></li>
<li><p><strong>Тип аутентификации</strong> - PSK;</p></li>
<li><p><strong>PSK</strong> - будет сгенерирован случайный PSK-ключ. Он потребуется, чтобы настроить подключение в Cisco;</p></li>
<li><p><strong>Идентификатор NGFW</strong> - введенный вами ключ будет использоваться для идентификации исходящего подключения. Введите также этот идентификатор в Cisco.</p></li>
</ul>
<p>3. Проверьте, что подключение установилось (в столбце <strong>Статусы</strong> зеленым цветом будет подсвечена надпись <strong>Установлено</strong>).</p>
<p>4. Проверьте наличие трафика между локальными сетями (TCP и web).</p>
</details>
<p>Если Cisco передает внешний IP-адрес вместо <strong>KeyID</strong> (проверьте, включив расширенный лог IPsec на Cisco), укажите в качестве <strong>Идентификатора удаленной стороны</strong> внешний IP-адрес Cisco.</p>
<details>
<summary>Настройка входящего подключения на Ideco NGFW</summary>
<p>Для настройки входящего IPsec-подключения на Ideco NGFW выполните действия:</p>
<p>1. В веб-интерфейсе Ideco NGFW откройте вкладку <strong>Сервисы -&gt; IPsec -&gt; Устройства (входящие подключения)</strong>.</p>
<p>2. Добавьте новое подключение:</p>
<ul class="simple">
<li><p><strong>Название</strong> - любое;</p></li>
<li><p><strong>Зона</strong> - укажите зону для добавления IPSec-подключения;</p></li>
<li><p><strong>Режим работы</strong> - выберите <strong>Туннельный</strong>;</p></li>
<li><p><strong>IP-адрес интерфейса туннеля</strong> - укажите IP-адрес интерфейса туннеля. Поле необязательное, заполняется при настройке BGP-соседства для динамической маршрутизации и для получения статистики обмена пакетами;</p></li>
<li><p><strong>Удаленный IP-адрес туннеля</strong> - укажите IP-адрес интерфейса туннеля Cisco. Поле необязательное. Для получения статистики о потере пакетов, средней задержке и джиттере заполните поля <strong>IP-адрес интрефейса туннеля</strong> и <strong>Удаленный IP-адрес туннеля</strong>. Они должны находиться в одной подсети. заполняется для получения статистики обмена пакетами;</p></li>
<li><p><strong>Домашние локальные сети</strong> - укажите локальную сеть Ideco NGFW;</p></li>
<li><p><strong>Удаленные локальные сети</strong> - укажите локальную сеть Cisco;</p></li>
<li><p><strong>Тип аутентификации</strong> - PSK;</p></li>
<li><p><strong>PSK</strong> - укажите PSK-ключ;</p></li>
<li><p><strong>Идентификатор удаленной стороны</strong> - вставьте идентификатор Cisco (параметр Key ID).</p></li>
</ul>
<p>3. Сохраните созданное подключение, затем нажмите на кнопку <strong>Включить</strong>.</p>
<p>4. Проверьте, что подключение установлено (в столбце <strong>Статусы</strong> зеленым цветом будет подсвечена надпись <strong>Установлено</strong>).</p>
<p>5. Проверьте наличие трафика между локальными сетями (TCP и web).</p>
</details>
<p>Итоговая конфигурация IKEv2 IPsec на Cisco IOS должна выглядеть следующим образом:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>crypto ikev2 proposal ikev2proposal
 encryption aes-cbc-256
 integrity sha256
 group 19

crypto ikev2 policy ikev2policy
 match fvrf any
 proposal ikev2proposal

crypto ikev2 keyring key
 peer strongswan
  address 5.5.5.5
  pre-shared-key local QWEqwe1234567890
  pre-shared-key remote QWEqwe1234567890

crypto ikev2 profile ikev2profile
 match identity remote key-id key-id
 authentication remote pre-share
 authentication local pre-share
 keyring local key

crypto ipsec transform-set TS esp-gcm 256
 mode tunnel

crypto map cmap 10 ipsec-isakmp
 set peer 5.5.5.5
 set transform-set TS
 set ikev2-profile ikev2profile
 match address cryptoacl

interface GigabitEthernet1
! внешний интерфейс
 ip address 1.1.1.1 255.255.255.0
 ip nat outside
 negotiation auto
 no mop enabled
 no mop sysid
 crypto map cmap

interface GigabitEthernet2
! локальный интерфейс
 ip address 2.2.2.2 255.255.255.0
 ip nat inside
 negotiation auto
 no mop enabled
 no mop sysid

ip nat inside source list NAT interface GigabitEthernet1 overload

ip access-list extended NAT
 deny   ip 2.2.2.0 0.0.0.255 3.3.3.0 0.0.0.255
 permit ip 2.2.2.0 0.0.0.255 any
ip access-list extended cryptoacl
 permit ip 2.2.2.0 0.0.0.255 3.3.3.0 0.0.0.255
</pre></div>
</div>
</section>
</section>
<section id="id2">
<h2><span class="section-number">1.2. </span>Настройка подключения в транспортном режиме<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>GRE over IPsec поддерживает мультикаст-трафик, что позволяет использовать более сложные механизмы маршрутизации, включая динамическую маршрутизацию через OSPF.</p>
<p>Также в GRE over IPsec не требуется задавать <strong>Домашние локальные сети</strong> и <strong>Удаленные локальные сети</strong>. Транспортный режим IPsec шифрует только то, что выше уровня IP, а заголовок IP оставляет без изменений.</p>
<p>Рассмотрим настройку подключения по схеме ниже:</p>
<p><img alt="" src=".gitbook/assets/connect-utm-to-cisco-via-ipsec.png" /></p>
<p>Для настройки подключения Cisco IOS к Ideco NGFW нужно следовать инструкции в каждом из пунктов.</p>
<details>
<summary>Первоначальная настройка Ideco NGFW и Cisco IOS</summary>
<section id="id3">
<h3><span class="section-number">1.2.1. </span>Настройка Ideco NGFW<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>Настройте на Ideco NGFW локальный и внешний интерфейсы. Подробная информация находится в статье <a class="reference internal" href="#/installation/initial-setup.md"><span class="xref myst">Первоначальная настройка</span></a>.</p>
</section>
<section id="cisco-ios">
<h3><span class="section-number">1.2.2. </span>Настройка Cisco IOS через консоль<a class="headerlink" href="#cisco-ios" title="Link to this heading">#</a></h3>
<p>1. Настройка локального интерфейса:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">enable</span>
<span class="n">conf</span> <span class="n">t</span>
<span class="n">interface</span> <span class="n">GigabitEthernet2</span>
<span class="n">ip</span> <span class="n">address</span> <span class="o">&lt;</span><span class="n">локальный</span> <span class="n">IP</span> <span class="n">Cisco</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">маска</span> <span class="n">подсети</span><span class="o">&gt;</span>
<span class="n">no</span> <span class="n">shutdown</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>2. Настройка внешнего интерфейса:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">interface</span> <span class="n">GigabitEthernet1</span>
<span class="n">ip</span> <span class="n">address</span> <span class="o">&lt;</span><span class="n">внешний</span> <span class="n">IP</span> <span class="n">Cisco</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">маска</span> <span class="n">подсети</span><span class="o">&gt;</span>
<span class="n">no</span> <span class="n">shutdown</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>3. Проверьте наличие связи между внешними интерфейсами Ideco NGFW и Cisco. Для этого в консоли Cisco используйте команду <code class="docutils literal notranslate"><span class="pre">ping</span> <span class="pre">&lt;внешний</span> <span class="pre">IP</span> <span class="pre">NGFW&gt;</span></code>. Результат вывода команды - наличие ICMP-ответов.</p>
<p>4. Сохранение настроек конфигурации:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">write</span> <span class="n">memory</span>
</pre></div>
</div>
<p>6. <strong>После сохранения настроек проверьте, что из локальной сети Cisco присутствует доступ в сеть интернет.</strong><br />
Для этого перейдите на какой-нибудь сайт (например: <a class="reference external" href="https://www.cisco.com">https://www.cisco.com/</a>) с устройства в локальной сети Cisco.</p>
</section>
<section id="ikev2-gre-over-ipsec-cisco">
<h3><span class="section-number">1.2.3. </span>Настройка IKEv2+GRE-over-IPsec на Cisco<a class="headerlink" href="#ikev2-gre-over-ipsec-cisco" title="Link to this heading">#</a></h3>
<p>1. Создание proposal (подробную информацию можно прочитать в <a class="reference external" href="https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/sec_conn_ike2vpn/configuration/xe-16-8/sec-flex-vpn-xe-16-8-book/sec-cfg-ikev2-flex.html#GUID-6F6D8166-508A-4669-9DDC-4FE7AE9B9939__GUID-A5DB59F5-70A0-421E-86AE-AE983B283E6F">статье</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conf</span> <span class="n">t</span>
<span class="n">crypto</span> <span class="n">ikev2</span> <span class="n">proposal</span> <span class="n">ikev2proposal</span>
<span class="n">encryption</span> <span class="n">aes</span><span class="o">-</span><span class="n">cbc</span><span class="o">-</span><span class="mi">256</span>
<span class="n">integrity</span> <span class="n">sha256</span>
<span class="n">group</span> <span class="mi">19</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>2. Создание policy (подробную информацию можно прочитать в <a class="reference external" href="https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/sec_conn_ike2vpn/configuration/xe-16-8/sec-flex-vpn-xe-16-8-book/sec-cfg-ikev2-flex.html#GUID-B5C198FE-97D9-4F74-88C6-6B5802195772__GUID-613A19C3-C5D6-456A-8D8A-4693F3553ED3">статье</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">crypto</span> <span class="n">ikev2</span> <span class="n">policy</span> <span class="n">ikev2policy</span>
<span class="k">match</span> <span class="n">fvrf</span> <span class="nb">any</span>
<span class="n">proposal</span> <span class="n">ikev2proposal</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>3. Создание peer (key_id - идентификатор удаленной стороны, т. е. Ideco NGFW). Подробную информацию можно прочитать в <a class="reference external" href="https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/sec_conn_ike2vpn/configuration/xe-16-8/sec-flex-vpn-xe-16-8-book/sec-cfg-ikev2-flex.html#GUID-D6AC9B42-1F22-4F60-A06A-A72575181659__GUID-A1CB9A0A-6098-475C-99BE-5D41009CD9A9">статье</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">crypto</span> <span class="n">ikev2</span> <span class="n">keyring</span> <span class="n">key</span>
<span class="n">peer</span> <span class="n">strongswan</span>
<span class="n">address</span> <span class="o">&lt;</span><span class="n">внешний</span> <span class="n">IP</span> <span class="n">NGFW</span><span class="o">&gt;</span>
<span class="n">identity</span> <span class="n">key</span><span class="o">-</span><span class="nb">id</span> <span class="o">&lt;</span><span class="n">key_id</span><span class="o">&gt;</span>
<span class="n">pre</span><span class="o">-</span><span class="n">shared</span><span class="o">-</span><span class="n">key</span> <span class="n">local</span> <span class="o">&lt;</span><span class="n">psk</span><span class="o">&gt;</span>
<span class="n">pre</span><span class="o">-</span><span class="n">shared</span><span class="o">-</span><span class="n">key</span> <span class="n">remote</span> <span class="o">&lt;</span><span class="n">psk</span><span class="o">&gt;</span>
<span class="n">exit</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>4. Создание IKEv2 profile (подробную информацию можно прочитать в <a class="reference external" href="https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/sec_conn_ike2vpn/configuration/xe-16-8/sec-flex-vpn-xe-16-8-book/sec-cfg-ikev2-flex.html#task_20288C58E8B1416897A763FABA8B0885__GUID-B31A2B1F-E07A-4DA9-8CEA-45D92E283D14">статье</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">crypto</span> <span class="n">ikev2</span> <span class="n">profile</span> <span class="n">ikev2profile</span>
<span class="k">match</span> <span class="n">identity</span> <span class="n">remote</span> <span class="n">address</span> <span class="o">&lt;</span><span class="n">внешний</span> <span class="n">IP</span> <span class="n">NGFW</span><span class="o">&gt;</span> <span class="mf">255.255.255.255</span>
<span class="n">authentication</span> <span class="n">remote</span> <span class="n">pre</span><span class="o">-</span><span class="n">share</span>
<span class="n">authentication</span> <span class="n">local</span> <span class="n">pre</span><span class="o">-</span><span class="n">share</span>
<span class="n">keyring</span> <span class="n">local</span> <span class="n">key</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>5. Настройка шифрования в esp:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">crypto</span> <span class="n">ipsec</span> <span class="n">transform</span><span class="o">-</span><span class="nb">set</span> <span class="n">TS</span> <span class="n">esp</span><span class="o">-</span><span class="n">gcm</span> <span class="mi">256</span>
<span class="n">mode</span> <span class="n">transport</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>6. Настройка профиля IPsec:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">crypto</span> <span class="n">ipsec</span> <span class="n">profile</span> <span class="n">SECURE</span><span class="o">-</span><span class="n">P</span>
<span class="nb">set</span> <span class="n">transform</span><span class="o">-</span><span class="nb">set</span> <span class="n">SECURE</span><span class="o">-</span><span class="n">TS</span> 
<span class="nb">set</span> <span class="n">pfs</span> <span class="n">group2</span>
</pre></div>
</div>
<p>7. Настройка GRE-over-IPsec-туннеля:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">interface</span> <span class="n">Tunnel1</span>
<span class="n">description</span> <span class="n">to_NGFW</span>
<span class="n">ip</span> <span class="n">address</span> <span class="o">&lt;</span><span class="n">IP</span> <span class="n">GRE</span><span class="o">-</span><span class="n">over</span><span class="o">-</span><span class="n">IPsec</span><span class="o">-</span><span class="n">интерфейса</span> <span class="n">Cisco</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">маска</span> <span class="n">подсети</span><span class="o">&gt;</span>
<span class="n">tunnel</span> <span class="n">source</span> <span class="o">&lt;</span><span class="n">внешний</span> <span class="n">IP</span> <span class="n">Cisco</span><span class="o">&gt;</span> 
<span class="n">tunnel</span> <span class="n">destination</span> <span class="o">&lt;</span><span class="n">внешний</span> <span class="n">IP</span> <span class="n">NGFW</span><span class="o">&gt;</span>
<span class="n">tunnel</span> <span class="n">protection</span> <span class="n">ipsec</span> <span class="n">profile</span> <span class="n">SECURE</span><span class="o">-</span><span class="n">P</span>
</pre></div>
</div>
<p>8. Настройка маршрута:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ip</span> <span class="n">route</span> <span class="o">&lt;</span><span class="n">локальная</span> <span class="n">подсеть</span> <span class="n">за</span> <span class="n">NGFW</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">маска</span> <span class="n">подсети</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">IP</span> <span class="n">GRE</span><span class="o">-</span><span class="n">over</span><span class="o">-</span><span class="n">IPsec</span><span class="o">-</span><span class="n">интерфейса</span> <span class="n">NGFW</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>10. Сохранение настроек конфигурации:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">write</span> <span class="n">memory</span>
</pre></div>
</div>
</details>
<details>
<summary>Настройка исходящего подключения на Ideco NGFW</summary>
<p>Для настройки исходящего IPsec-подключения на Ideco NGFW выполните действия:</p>
<p>1. В веб-интерфейсе Ideco NGFW откройте вкладку <strong>Сервисы -&gt; IPsec -&gt; Исходящие подключения</strong>.</p>
<p>2. Добавьте новое подключение:</p>
<ul class="simple">
<li><p><strong>Название</strong> - любое;</p></li>
<li><p><strong>Зона</strong> - укажите зону для добавления IPSec подключения;</p></li>
<li><p><strong>Режим работы</strong> - выберите <strong>Транспортный</strong>;</p></li>
<li><p><strong>Адрес удаленного устройства</strong> - введите IP-адрес Cisco;</p></li>
<li><p><strong>IP-адрес интерфейса туннеля</strong> - укажите IP-адрес интерфейса GRE-туннеля NGFW;</p></li>
<li><p><strong>Удаленный IP-адрес туннеля</strong> - укажите IP-адрес интерфейса GRE-туннеля Cisco. Поле необязательное и заполняется для получения статистики о потере пакетов, средней задержке и джиттере.</p></li>
<li><p><strong>Тип аутентификации</strong> - PSK;</p></li>
<li><p><strong>PSK</strong> - будет сгенерирован случайный PSK-ключ. Он потребуется, чтобы настроить подключение в Cisco;</p></li>
<li><p><strong>NGFW идентификатор</strong> - введенный вами ключ будет использоваться для идентификации исходящего подключения. Введите также этот идентификатор в Cisco.</p></li>
</ul>
<p>3. Проверьте, что подключение установилось (в столбце <strong>Статусы</strong> зеленым цветом будет подсвечена надпись <strong>Установлено</strong>).</p>
<p>4. Проверьте наличие трафика между локальными сетями (TCP и web).</p>
</details>
<details>
<summary>Настройка входящего подключения на Ideco NGFW</summary>
<p>Для настройки входящего IPsec-подключения на Ideco NGFW выполните действия:</p>
<p>1. В веб-интерфейсе Ideco NGFW откройте вкладку <strong>Сервисы -&gt; IPsec -&gt; Устройства(входящие подключения)</strong>.</p>
<p>2. Добавьте новое подключение:</p>
<ul class="simple">
<li><p><strong>Название</strong> - любое;</p></li>
<li><p><strong>Зона</strong> - укажите зону для добавления IPsec-подключения;</p></li>
<li><p><strong>Режим работы</strong> - выберите <strong>Транспортный</strong>;</p></li>
<li><p><strong>IP-адрес интерфейса туннеля</strong> - укажите IP-адрес интерфейса GRE-туннеля NGFW;</p></li>
<li><p><strong>Удаленный IP-адрес туннеля</strong> - укажите IP-адрес интерфейса GRE-туннеля Cisco. Поле необязательное и заполняется для получения статистики о потере пакетов, средней задержке и джиттере.</p></li>
<li><p><strong>Тип аутентификации</strong> - PSK;</p></li>
<li><p><strong>PSK</strong> - укажите PSK-ключ;</p></li>
<li><p><strong>Идентификатор удаленной стороны</strong> - вставьте идентификатор Cisco (параметр Key ID).</p></li>
</ul>
<p>3. Сохраните созданное подключение, затем нажмите на кнопку <strong>Включить</strong>.</p>
<p>4. Проверьте, что подключение установлено (в столбце <strong>Статусы</strong> зеленым цветом будет подсвечена надпись <strong>Установлено</strong>).</p>
<p>5. Проверьте наличие трафика между локальными сетями (TCP и web).</p>
</details>
<p>Итоговая конфигурация IKEv2 GRE over IPsec на Cisco IOS должна выглядеть следующим образом:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>crypto ikev2 proposal ikev2proposal
 encryption aes-cbc-256
 integrity sha256
 group 19

crypto ikev2 policy ikev2policy
 match fvrf any
 proposal ikev2proposal

crypto ikev2 keyring key
 peer strongswan
  address 172.168.10.25
  pre-shared-key local QWEqwe1234567890
  pre-shared-key remote QWEqwe1234567890

crypto ikev2 profile ikev2profile
 match identity remote key-id key-id
 authentication remote pre-share
 authentication local pre-share
 keyring local key

crypto ipsec transform-set TS esp-gcm 256
 mode transport

crypto ipsec profile SECURE-P
 set transform-set SECURE-TS 
 set pfs group2
!
interface Tunnel1
 description to_NGFW
 ip address 192.168.200.1 255.255.255.0
 tunnel source 192.168.233.204 # &lt;внешний IP Cisco&gt;
 tunnel destination 172.168.10.25 # &lt;внешний IP NGFW&gt;
 tunnel protection ipsec profile SECURE-P
!
ip route 192.168.0.0 255.255.255.0 192.168.200.2

interface GigabitEthernet1
! внешний интерфейс
 ip address 192.168.233.204 255.255.255.0
 crypto map cmap

interface GigabitEthernet2
! локальный интерфейс
 ip address 192.168.10.1 255.255.255.0

</pre></div>
</div>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="utm-to-mikrotik-vpn.html"
       title="предыдущая страница">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">назад</p>
        <p class="prev-next-title"><span class="section-number">1. </span>Подключение MikroTik и Ideco NGFW по L2TP/IPsec и IKev2/IPsec</p>
      </div>
    </a>
    <a class="right-next"
       href="ipsec-connection-pfsense-to-utm.html"
       title="следующая страница">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">вперёд</p>
        <p class="prev-next-title"><span class="section-number">1. </span>Подключение pfSense к Ideco NGFW по IPsec</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Содержание
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1.1. Настройка подключения в туннельном режиме</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ideco-ngfw">1.1.1. Настройка Ideco NGFW</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cisco-ios-ex">1.1.2. Настройка Cisco IOS EX</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cisco">1.1.2.1. Настройка Cisco через консоль</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ikev2-ipsec-cisco">1.1.3. Настройка IKEv2+IPsec на Cisco</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">1.2. Настройка подключения в транспортном режиме</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">1.2.1. Настройка Ideco NGFW</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cisco-ios">1.2.2. Настройка Cisco IOS через консоль</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ikev2-gre-over-ipsec-cisco">1.2.3. Настройка IKEv2+GRE-over-IPsec на Cisco</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
По Ideco
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Копирайт 2024, Ideco.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>